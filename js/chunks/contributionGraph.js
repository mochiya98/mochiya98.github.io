(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,function(t,i,s){"use strict";function h(t){return-(Math.pow(t-1,2)-1)}s.r(i);const e=(t,i,s)=>(s<0&&(s+=1),s>1&&(s-=1),s<1/6?t+6*(i-t)*s:s<.5?i:s<2/3?t+(i-t)*(2/3-s)*6:t);var r=(t,i,s)=>{let h,r,n;if(t/=360,0==i)h=r=n=s;else{const o=s<.5?s*(1+i):s+i-s*i,a=2*s-o;h=e(a,o,t+1/3),r=e(a,o,t),n=e(a,o,t-1/3)}return[h,r,n]};const n="precision highp float;precision highp int;attribute vec3 position;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;void main(){vec4 t;t.xyz=position;t.w=1.0;gl_Position=projectionMatrix*modelViewMatrix*t;}",o=()=>"precision highp float;precision highp int;void main(){gl_FragColor.xyz=vec3(0.93333);gl_FragColor.w=1.0;}",a="precision highp float;precision highp int;attribute vec3 position;attribute vec3 normal;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat3 normalMatrix;varying vec3 vN;void main(){vN=normalize(normalMatrix*normal);vec4 t;t.w=1.0;t.xyz=position;gl_Position=projectionMatrix*modelViewMatrix*t;}",u="precision highp int;precision highp float;uniform vec3 color;varying vec3 vN;void main(){float t=(max(dot(vN,vec3(0.0,0.5734624,0.8192319)),0.0)*1.07);gl_FragColor.xyz=((((color-1.0)*vec3((0.666+(t/3.0))))+1.0)+(vec3((t-0.82))*0.5));gl_FragColor.w=1.0;}";function l(t){let i=t[0],s=t[1],h=t[2];return Math.sqrt(i*i+s*s+h*h)}function c(t,i){return t[0]=i[0],t[1]=i[1],t[2]=i[2],t}function d(t,i,s){return t[0]=i[0]+s[0],t[1]=i[1]+s[1],t[2]=i[2]+s[2],t}function f(t,i,s){return t[0]=i[0]-s[0],t[1]=i[1]-s[1],t[2]=i[2]-s[2],t}function v(t,i,s){return t[0]=i[0]*s,t[1]=i[1]*s,t[2]=i[2]*s,t}function p(t,i){let s=i[0],h=i[1],e=i[2],r=s*s+h*h+e*e;return r>0&&(r=1/Math.sqrt(r)),t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t}function m(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]}function w(t,i,s){let h=i[0],e=i[1],r=i[2],n=s[0],o=s[1],a=s[2];return t[0]=e*a-r*o,t[1]=r*n-h*a,t[2]=h*o-e*n,t}const M=function(){const t=[0,0,0],i=[0,0,0];return function(s,h){c(t,s),c(i,h),p(t,t),p(i,i);let e=m(t,i);return e>1?0:e<-1?Math.PI:Math.acos(e)}}();class g extends Array{constructor(t,i,s){return void 0===t&&(t=0),void 0===i&&(i=t),void 0===s&&(s=t),super(t,i,s),this}get x(){return this[0]}set x(t){this[0]=t}get y(){return this[1]}set y(t){this[1]=t}get z(){return this[2]}set z(t){this[2]=t}set(t,i,s){return void 0===i&&(i=t),void 0===s&&(s=t),function(t,i,s,h){t[0]=i,t[1]=s,t[2]=h}(this,t,i,s),this}t(t){return c(this,t),this}add(t,i){return i?d(this,t,i):d(this,this,t),this}sub(t,i){return i?f(this,t,i):f(this,this,t),this}multiply(t){var i,s,h;return t.length?(s=this,h=t,(i=this)[0]=s[0]*h[0],i[1]=s[1]*h[1],i[2]=s[2]*h[2]):v(this,this,t),this}i(t){var i,s,h;return t.length?(s=this,h=t,(i=this)[0]=s[0]/h[0],i[1]=s[1]/h[1],i[2]=s[2]/h[2]):v(this,this,1/t),this}inverse(t){var i,s;return void 0===t&&(t=this),s=t,(i=this)[0]=1/s[0],i[1]=1/s[1],i[2]=1/s[2],this}s(){return l(this)}h(t){return t?function(t,i){let s=i[0]-t[0],h=i[1]-t[1],e=i[2]-t[2];return Math.sqrt(s*s+h*h+e*e)}(this,t):l(this)}o(){return this.u()}u(t){return t?function(t,i){let s=i[0]-t[0],h=i[1]-t[1],e=i[2]-t[2];return s*s+h*h+e*e}(this,t):function(t){let i=t[0],s=t[1],h=t[2];return i*i+s*s+h*h}(this)}l(t){var i,s;return void 0===t&&(t=this),s=t,(i=this)[0]=-s[0],i[1]=-s[1],i[2]=-s[2],this}v(t,i){return w(this,t,i),this}scale(t){return v(this,this,t),this}normalize(){return p(this,this),this}p(t){return m(this,t)}m(t){return s=t,(i=this)[0]===s[0]&&i[1]===s[1]&&i[2]===s[2];var i,s}M(t){return function(t,i,s){let h=i[0],e=i[1],r=i[2],n=s[3]*h+s[7]*e+s[11]*r+s[15];n=n||1,t[0]=(s[0]*h+s[4]*e+s[8]*r+s[12])/n,t[1]=(s[1]*h+s[5]*e+s[9]*r+s[13])/n,t[2]=(s[2]*h+s[6]*e+s[10]*r+s[14])/n}(this,this,t),this}g(t){return function(t,i,s){let h=i[0],e=i[1],r=i[2],n=s[0],o=s[1],a=s[2],u=o*r-a*e,l=a*h-n*r,c=n*e-o*h,d=o*c-a*l,f=a*u-n*c,v=n*l-o*u,p=2*s[3];u*=p,l*=p,c*=p,d*=2,f*=2,v*=2,t[0]=h+u+d,t[1]=e+l+f,t[2]=r+c+v}(this,this,t),this}angle(t){return M(this,t)}A(t,i){return function(t,i,s,h){let e=i[0],r=i[1],n=i[2];t[0]=e+h*(s[0]-e),t[1]=r+h*(s[1]-r),t[2]=n+h*(s[2]-n)}(this,this,t,i),this}clone(){return new g(this[0],this[1],this[2])}_(t,i){return void 0===i&&(i=0),this[0]=t[i],this[1]=t[i+1],this[2]=t[i+2],this}toArray(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this[0],t[i+1]=this[1],t[i+2]=this[2],t}F(t){const i=this[0],s=this[1],h=this[2];return this[0]=t[0]*i+t[4]*s+t[8]*h,this[1]=t[1]*i+t[5]*s+t[9]*h,this[2]=t[2]*i+t[6]*s+t[10]*h,this.normalize()}}const x=new g;let y=0,A=0;class b{constructor(t,i){void 0===i&&(i={}),this.S=t,this.attributes=i,this.id=y++,this.O={start:0,count:0},this.X=0,this.S.N.j(null),this.S.N.Y=null,this.Z=this.S.N.state;for(let t in i)this.B(t,i[t])}B(t,i){if(this.attributes[t]=i,i.id=A++,i.size=i.size||1,i.type=i.type||(i.data.constructor===Float32Array?this.S.FLOAT:i.data.constructor===Uint16Array?this.S.UNSIGNED_SHORT:this.S.UNSIGNED_INT),i.target="index"===t?this.S.ELEMENT_ARRAY_BUFFER:this.S.ARRAY_BUFFER,i.normalize=i.normalize||!1,i.buffer=this.S.createBuffer(),i.count=i.data.length/i.size,i.divisor=i.C?"number"==typeof i.C?i.C:1:0,i.D=!1,this.V(i),i.divisor){if(this.q=!0,this.X&&this.X!==i.count*i.divisor)return console.warn("geometry has multiple instanced buffers of different length"),this.X=Math.min(this.X,i.count*i.divisor);this.X=i.count*i.divisor}else"index"===t?this.O.count=i.count:this.attributes.index||(this.O.count=Math.max(this.O.count,i.count))}V(t){this.Z.I!==t.id&&(this.S.bindBuffer(t.target,t.buffer),this.Z.I=t.id),this.S.bufferData(t.target,t.data,this.S.STATIC_DRAW),t.D=!1}L(t){this.B("index",t)}P(t,i){this.O.start=t,this.O.count=i}G(t){this.X=t}U(t){this.R=this.S.N.T(),this.S.N.j(this.R),this.k(t)}k(t){t.W.forEach((t,i)=>{if(!this.attributes[i])return void console.warn("active attribute "+i+" not being supplied");const s=this.attributes[i];this.S.bindBuffer(s.target,s.buffer),this.Z.I=s.id,this.S.vertexAttribPointer(t,s.size,s.type,s.normalize,0,0),this.S.enableVertexAttribArray(t),this.S.N.H(t,s.divisor)}),this.attributes.index&&this.S.bindBuffer(this.S.ELEMENT_ARRAY_BUFFER,this.attributes.index.buffer)}draw(t){let{J:i,mode:s=this.S.TRIANGLES,K:h=!1}=t;h||(this.R||this.U(i),this.S.N.j(this.R),this.S.N.Y=this.id),i.W.forEach((t,i)=>{const s=this.attributes[i];s.D&&this.V(s)}),this.q?this.attributes.index?this.S.N.$(s,this.O.count,this.attributes.index.type,this.O.start,this.X):this.S.N.tt(s,this.O.start,this.O.count,this.X):this.attributes.index?this.S.drawElements(s,this.O.count,this.attributes.index.type,this.O.start):this.S.drawArrays(s,this.O.start,this.O.count)}it(t){!t&&this.attributes.position&&(t=this.attributes.position.data),t||console.warn("No position buffer found to compute bounds"),this.bounds||(this.bounds={min:new g,max:new g,st:new g,scale:new g,ht:1/0});const i=this.bounds.min,s=this.bounds.max,h=this.bounds.st,e=this.bounds.scale;i.set(1/0),s.set(-1/0);for(let h=0,e=t.length;h<e;h+=3){const e=t[h],r=t[h+1],n=t[h+2];i.x=Math.min(e,i.x),i.y=Math.min(r,i.y),i.z=Math.min(n,i.z),s.x=Math.max(e,s.x),s.y=Math.max(r,s.y),s.z=Math.max(n,s.z)}e.sub(s,i),h.add(i,s).i(2)}et(t){!t&&this.attributes.position&&(t=this.attributes.position.data),t||console.warn("No position buffer found to compute bounds"),this.bounds||this.it(t);let i=0;for(let s=0,h=t.length;s<h;s+=3)x._(t,s),i=Math.max(i,this.bounds.st.u(x));this.bounds.ht=Math.sqrt(i)}remove(){this.R&&this.S.N.rt(this.R);for(let t in this.attributes)this.S.deleteBuffer(this.attributes[t].buffer),delete this.attributes[t]}}let _=0;const F={};class E{constructor(t,i){let{nt:s,ot:h,at:e={},ut:r=!1,cullFace:n=t.BACK,frontFace:o=t.CCW,lt:a=!0,ct:u=!0,depthFunc:l=t.LESS}=void 0===i?{}:i;this.S=t,this.at=e,this.id=_++,s||console.warn("vertex shader not supplied"),h||console.warn("fragment shader not supplied"),this.ut=r,this.cullFace=n,this.frontFace=o,this.lt=a,this.ct=u,this.depthFunc=l,this.blendFunc={},this.blendEquation={},this.ut&&!this.blendFunc.src&&(this.S.N.dt?this.ft(this.S.ONE,this.S.ONE_MINUS_SRC_ALPHA):this.ft(this.S.SRC_ALPHA,this.S.ONE_MINUS_SRC_ALPHA));const c=t.createShader(t.VERTEX_SHADER);t.shaderSource(c,s),t.compileShader(c),""!==t.getShaderInfoLog(c)&&console.warn(t.getShaderInfoLog(c)+"\nVertex Shader\n"+S(s));const d=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(d,h),t.compileShader(d),""!==t.getShaderInfoLog(d)&&console.warn(t.getShaderInfoLog(d)+"\nFragment Shader\n"+S(h)),this.J=t.createProgram(),t.attachShader(this.J,c),t.attachShader(this.J,d),t.linkProgram(this.J),!t.getProgramParameter(this.J,t.LINK_STATUS))return console.warn(t.getProgramInfoLog(this.J));t.deleteShader(c),t.deleteShader(d),this.vt=new Map;let f=t.getProgramParameter(this.J,t.ACTIVE_UNIFORMS);for(let i=0;i<f;i++){let s=t.getActiveUniform(this.J,i);this.vt.set(s,t.getUniformLocation(this.J,s.name));const h=s.name.match(/(\w+)/g);s.pt=h[0],3===h.length?(s.wt=!0,s.Mt=Number(h[1]),s.gt=h[2]):2===h.length&&isNaN(Number(h[1]))&&(s.xt=!0,s.gt=h[1])}this.W=new Map;let v=t.getProgramParameter(this.J,t.ACTIVE_ATTRIBUTES);for(let i=0;i<v;i++){let s=t.getActiveAttrib(this.J,i);this.W.set(s.name,t.getAttribLocation(this.J,s.name))}}ft(t,i,s,h){this.blendFunc.src=t,this.blendFunc.yt=i,this.blendFunc.At=s,this.blendFunc.bt=h,t&&(this.ut=!0)}_t(t,i){this.blendEquation.Ft=t,this.blendEquation.Et=i}zt(){this.lt?this.S.N.enable(this.S.DEPTH_TEST):this.S.N.disable(this.S.DEPTH_TEST),this.cullFace?this.S.N.enable(this.S.CULL_FACE):this.S.N.disable(this.S.CULL_FACE),this.blendFunc.src?this.S.N.enable(this.S.BLEND):this.S.N.disable(this.S.BLEND),this.cullFace&&this.S.N.St(this.cullFace),this.S.N.Ot(this.frontFace),this.S.N.Xt(this.ct),this.S.N.jt(this.depthFunc),this.blendFunc.src&&this.S.N.ft(this.blendFunc.src,this.blendFunc.yt,this.blendFunc.At,this.blendFunc.bt),this.blendEquation.Ft&&this.S.N._t(this.blendEquation.Ft,this.blendEquation.Et)}Nt(t){let{Yt:i=!1,Zt:s=!1}=void 0===t?{}:t,h=-1;i||(this.S.useProgram(this.J),this.S.N.Bt=this.id),this.vt.forEach((t,i)=>{let s=i.pt,e=this.at[s];if(i.xt&&(e=e[i.gt],s+="."+i.gt),i.wt&&(e=e[i.Mt][i.gt],s+="["+i.Mt+"]."+i.gt),!e)return X("Active uniform "+s+" has not been supplied");if(e&&void 0===e.value)return X(s+" uniform is missing a value parameter");if(e.value.Ct)return h+=1,e.value.update(h),z(this.S,i.type,t,h);if(e.value.length&&e.value[0].Ct){const s=[];return e.value.forEach(t=>{h+=1,t.update(h),s.push(h)}),z(this.S,i.type,t,s)}z(this.S,i.type,t,e.value)}),this.zt(),s&&this.S.N.Ot(this.frontFace===this.S.CCW?this.S.CW:this.S.CCW)}remove(){this.S.deleteProgram(this.J)}}function z(t,i,s,h){h=h.length?function(t){const i=t.length,s=t[0].length;if(void 0===s)return t;const h=i*s;let e=F[h];e||(F[h]=e=new Float32Array(h));for(let h=0;h<i;h++)e.set(t[h],h*s);return e}(h):h;const e=t.N.state.vt.get(s);if(h.length)if(void 0===e)t.N.state.vt.set(s,h.slice(0));else{if(function(t,i){if(t.length!==i.length)return!1;for(let s=0,h=t.length;s<h;s++)if(t[s]!==i[s])return!1;return!0}(e,h))return;e.set(h),t.N.state.vt.set(s,e)}else{if(e===h)return;t.N.state.vt.set(s,h)}switch(i){case 5126:return h.length?t.uniform1fv(s,h):t.uniform1f(s,h);case 35664:return t.uniform2fv(s,h);case 35665:return t.uniform3fv(s,h);case 35666:return t.uniform4fv(s,h);case 35670:case 5124:case 35678:case 35680:return h.length?t.uniform1iv(s,h):t.uniform1i(s,h);case 35671:case 35667:return t.uniform2iv(s,h);case 35672:case 35668:return t.uniform3iv(s,h);case 35673:case 35669:return t.uniform4iv(s,h);case 35674:return t.uniformMatrix2fv(s,!1,h);case 35675:return t.uniformMatrix3fv(s,!1,h);case 35676:return t.uniformMatrix4fv(s,!1,h)}}function S(t){let i=t.split("\n");for(let t=0;t<i.length;t++)i[t]=t+1+": "+i[t];return i.join("\n")}let O=0;function X(t){O>100||(console.warn(t),++O>100&&console.warn("More than 100 program warnings - stopping logs."))}function j(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function N(t,i,s){let h=i[0],e=i[1],r=i[2],n=i[3],o=i[4],a=i[5],u=i[6],l=i[7],c=i[8],d=i[9],f=i[10],v=i[11],p=i[12],m=i[13],w=i[14],M=i[15],g=s[0],x=s[1],y=s[2],A=s[3];return t[0]=g*h+x*o+y*c+A*p,t[1]=g*e+x*a+y*d+A*m,t[2]=g*r+x*u+y*f+A*w,t[3]=g*n+x*l+y*v+A*M,g=s[4],x=s[5],y=s[6],A=s[7],t[4]=g*h+x*o+y*c+A*p,t[5]=g*e+x*a+y*d+A*m,t[6]=g*r+x*u+y*f+A*w,t[7]=g*n+x*l+y*v+A*M,g=s[8],x=s[9],y=s[10],A=s[11],t[8]=g*h+x*o+y*c+A*p,t[9]=g*e+x*a+y*d+A*m,t[10]=g*r+x*u+y*f+A*w,t[11]=g*n+x*l+y*v+A*M,g=s[12],x=s[13],y=s[14],A=s[15],t[12]=g*h+x*o+y*c+A*p,t[13]=g*e+x*a+y*d+A*m,t[14]=g*r+x*u+y*f+A*w,t[15]=g*n+x*l+y*v+A*M,t}class Y extends Array{constructor(t,i,s,h,e,r,n,o,a,u,l,c,d,f,v,p){return void 0===t&&(t=1),void 0===i&&(i=0),void 0===s&&(s=0),void 0===h&&(h=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===u&&(u=0),void 0===l&&(l=1),void 0===c&&(c=0),void 0===d&&(d=0),void 0===f&&(f=0),void 0===v&&(v=0),void 0===p&&(p=1),super(t,i,s,h,e,r,n,o,a,u,l,c,d,f,v,p),this}set x(t){this[12]=t}get x(){return this[12]}set y(t){this[13]=t}get y(){return this[13]}set z(t){this[14]=t}get z(){return this[14]}set w(t){this[15]=t}get w(){return this[15]}set(t,i,s,h,e,r,n,o,a,u,l,c,d,f,v,p){return t.length?this.t(t):(function(t,i,s,h,e,r,n,o,a,u,l,c,d,f,v,p,m){t[0]=i,t[1]=s,t[2]=h,t[3]=e,t[4]=r,t[5]=n,t[6]=o,t[7]=a,t[8]=u,t[9]=l,t[10]=c,t[11]=d,t[12]=f,t[13]=v,t[14]=p,t[15]=m}(this,t,i,s,h,e,r,n,o,a,u,l,c,d,f,v,p),this)}translate(t,i){return void 0===i&&(i=this),function(t,i,s){let h,e,r,n,o,a,u,l,c,d,f,v,p=s[0],m=s[1],w=s[2];i===t?(t[12]=i[0]*p+i[4]*m+i[8]*w+i[12],t[13]=i[1]*p+i[5]*m+i[9]*w+i[13],t[14]=i[2]*p+i[6]*m+i[10]*w+i[14],t[15]=i[3]*p+i[7]*m+i[11]*w+i[15]):(h=i[0],e=i[1],r=i[2],n=i[3],o=i[4],a=i[5],u=i[6],l=i[7],c=i[8],d=i[9],f=i[10],v=i[11],t[0]=h,t[1]=e,t[2]=r,t[3]=n,t[4]=o,t[5]=a,t[6]=u,t[7]=l,t[8]=c,t[9]=d,t[10]=f,t[11]=v,t[12]=h*p+o*m+c*w+i[12],t[13]=e*p+a*m+d*w+i[13],t[14]=r*p+u*m+f*w+i[14],t[15]=n*p+l*m+v*w+i[15])}(this,i,t),this}Dt(t,i){return void 0===i&&(i=this),function(t,i,s){let h=Math.sin(s),e=Math.cos(s),r=i[4],n=i[5],o=i[6],a=i[7],u=i[8],l=i[9],c=i[10],d=i[11];i!==t&&(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t[4]=r*e+u*h,t[5]=n*e+l*h,t[6]=o*e+c*h,t[7]=a*e+d*h,t[8]=u*e-r*h,t[9]=l*e-n*h,t[10]=c*e-o*h,t[11]=d*e-a*h}(this,i,t),this}Vt(t,i){return void 0===i&&(i=this),function(t,i,s){let h=Math.sin(s),e=Math.cos(s),r=i[0],n=i[1],o=i[2],a=i[3],u=i[8],l=i[9],c=i[10],d=i[11];i!==t&&(t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t[0]=r*e-u*h,t[1]=n*e-l*h,t[2]=o*e-c*h,t[3]=a*e-d*h,t[8]=r*h+u*e,t[9]=n*h+l*e,t[10]=o*h+c*e,t[11]=a*h+d*e}(this,i,t),this}qt(t,i){return void 0===i&&(i=this),function(t,i,s){let h=Math.sin(s),e=Math.cos(s),r=i[0],n=i[1],o=i[2],a=i[3],u=i[4],l=i[5],c=i[6],d=i[7];i!==t&&(t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t[0]=r*e+u*h,t[1]=n*e+l*h,t[2]=o*e+c*h,t[3]=a*e+d*h,t[4]=u*e-r*h,t[5]=l*e-n*h,t[6]=c*e-o*h,t[7]=d*e-a*h}(this,i,t),this}scale(t,i){return void 0===i&&(i=this),function(t,i,s){let h=s[0],e=s[1],r=s[2];t[0]=i[0]*h,t[1]=i[1]*h,t[2]=i[2]*h,t[3]=i[3]*h,t[4]=i[4]*e,t[5]=i[5]*e,t[6]=i[6]*e,t[7]=i[7]*e,t[8]=i[8]*r,t[9]=i[9]*r,t[10]=i[10]*r,t[11]=i[11]*r,t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]}(this,i,"number"==typeof t?[t,t,t]:t),this}multiply(t,i){return i?N(this,t,i):N(this,this,t),this}identity(){return j(this),this}t(t){var i,s;return s=t,(i=this)[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i[4]=s[4],i[5]=s[5],i[6]=s[6],i[7]=s[7],i[8]=s[8],i[9]=s[9],i[10]=s[10],i[11]=s[11],i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15],this}It(t){let{Lt:i,Pt:s,near:h,Gt:e}=void 0===t?{}:t;return function(t,i,s,h,e){let r=1/Math.tan(i/2),n=1/(h-e);t[0]=r/s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(e+h)*n,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*e*h*n,t[15]=0}(this,i,s,h,e),this}Ut(t){let{left:i,right:s,bottom:h,top:e,near:r,Gt:n}=t;return function(t,i,s,h,e,r,n){let o=1/(i-s),a=1/(h-e),u=1/(r-n);t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(i+s)*o,t[13]=(e+h)*a,t[14]=(n+r)*u,t[15]=1}(this,i,s,h,e,r,n),this}Rt(t){return function(t,i){let s=i[0],h=i[1],e=i[2],r=i[3],n=s+s,o=h+h,a=e+e,u=s*n,l=h*n,c=h*o,d=e*n,f=e*o,v=e*a,p=r*n,m=r*o,w=r*a;t[0]=1-c-v,t[1]=l+w,t[2]=d-m,t[3]=0,t[4]=l-w,t[5]=1-u-v,t[6]=f+p,t[7]=0,t[8]=d+m,t[9]=f-p,t[10]=1-u-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this}setPosition(t){return this.x=t[0],this.y=t[1],this.z=t[2],this}inverse(t){return void 0===t&&(t=this),function(t,i){let s=i[0],h=i[1],e=i[2],r=i[3],n=i[4],o=i[5],a=i[6],u=i[7],l=i[8],c=i[9],d=i[10],f=i[11],v=i[12],p=i[13],m=i[14],w=i[15],M=s*o-h*n,g=s*a-e*n,x=s*u-r*n,y=h*a-e*o,A=h*u-r*o,b=e*u-r*a,_=l*p-c*v,F=l*m-d*v,E=l*w-f*v,z=c*m-d*p,S=c*w-f*p,O=d*w-f*m,X=M*O-g*S+x*z+y*E-A*F+b*_;X&&(X=1/X,t[0]=(o*O-a*S+u*z)*X,t[1]=(e*S-h*O-r*z)*X,t[2]=(p*b-m*A+w*y)*X,t[3]=(d*A-c*b-f*y)*X,t[4]=(a*E-n*O-u*F)*X,t[5]=(s*O-e*E+r*F)*X,t[6]=(m*x-v*b-w*g)*X,t[7]=(l*b-d*x+f*g)*X,t[8]=(n*S-o*E+u*_)*X,t[9]=(h*E-s*S-r*_)*X,t[10]=(v*A-p*x+w*M)*X,t[11]=(c*x-l*A-f*M)*X,t[12]=(o*F-n*z-a*_)*X,t[13]=(s*z-h*F+e*_)*X,t[14]=(p*g-v*y-m*M)*X,t[15]=(l*y-c*g+d*M)*X)}(this,t),this}Tt(t,i,s){return function(t,i,s,h){let e=i[0],r=i[1],n=i[2],o=i[3],a=e+e,u=r+r,l=n+n,c=e*a,d=e*u,f=e*l,v=r*u,p=r*l,m=n*l,w=o*a,M=o*u,g=o*l,x=h[0],y=h[1],A=h[2];t[0]=(1-(v+m))*x,t[1]=(d+g)*x,t[2]=(f-M)*x,t[3]=0,t[4]=(d-g)*y,t[5]=(1-(c+m))*y,t[6]=(p+w)*y,t[7]=0,t[8]=(f+M)*A,t[9]=(p-w)*A,t[10]=(1-(c+v))*A,t[11]=0,t[12]=s[0],t[13]=s[1],t[14]=s[2],t[15]=1}(this,t,i,s),this}kt(t){return function(t,i){let s=i[0]+i[5]+i[10],h=0;s>0?(h=2*Math.sqrt(s+1),t[3]=.25*h,t[0]=(i[6]-i[9])/h,t[1]=(i[8]-i[2])/h,t[2]=(i[1]-i[4])/h):i[0]>i[5]&&i[0]>i[10]?(h=2*Math.sqrt(1+i[0]-i[5]-i[10]),t[3]=(i[6]-i[9])/h,t[0]=.25*h,t[1]=(i[1]+i[4])/h,t[2]=(i[8]+i[2])/h):i[5]>i[10]?(h=2*Math.sqrt(1+i[5]-i[0]-i[10]),t[3]=(i[8]-i[2])/h,t[0]=(i[1]+i[4])/h,t[1]=.25*h,t[2]=(i[6]+i[9])/h):(h=2*Math.sqrt(1+i[10]-i[0]-i[5]),t[3]=(i[1]-i[4])/h,t[0]=(i[8]+i[2])/h,t[1]=(i[6]+i[9])/h,t[2]=.25*h)}(t,this),this}Qt(t){var i,s;return s=this,(i=t)[0]=s[12],i[1]=s[13],i[2]=s[14],this}Wt(t){return function(t,i){let s=i[0],h=i[1],e=i[2],r=i[4],n=i[5],o=i[6],a=i[8],u=i[9],l=i[10];t[0]=Math.sqrt(s*s+h*h+e*e),t[1]=Math.sqrt(r*r+n*n+o*o),t[2]=Math.sqrt(a*a+u*u+l*l)}(t,this),this}Ht(){return function(t){let i=t[0],s=t[1],h=t[2],e=t[4],r=t[5],n=t[6],o=t[8],a=t[9],u=t[10];const l=i*i+s*s+h*h,c=e*e+r*r+n*n,d=o*o+a*a+u*u;return Math.sqrt(Math.max(l,c,d))}(this)}Jt(t,i,s){return function(t,i,s,h){let e=i[0],r=i[1],n=i[2],o=h[0],a=h[1],u=h[2],l=e-s[0],c=r-s[1],d=n-s[2],f=l*l+c*c+d*d;f>0&&(l*=f=1/Math.sqrt(f),c*=f,d*=f);let v=a*d-u*c,p=u*l-o*d,m=o*c-a*l;(f=v*v+p*p+m*m)>0&&(v*=f=1/Math.sqrt(f),p*=f,m*=f),t[0]=v,t[1]=p,t[2]=m,t[3]=0,t[4]=c*m-d*p,t[5]=d*v-l*m,t[6]=l*p-c*v,t[7]=0,t[8]=l,t[9]=c,t[10]=d,t[11]=0,t[12]=e,t[13]=r,t[14]=n,t[15]=1}(this,t,i,s),this}Kt(){return function(t){let i=t[0],s=t[1],h=t[2],e=t[3],r=t[4],n=t[5],o=t[6],a=t[7],u=t[8],l=t[9],c=t[10],d=t[11],f=t[12],v=t[13],p=t[14],m=t[15];return(i*n-s*r)*(c*m-d*p)-(i*o-h*r)*(l*m-d*v)+(i*a-e*r)*(l*p-c*v)+(s*o-h*n)*(u*m-d*f)-(s*a-e*n)*(u*p-c*f)+(h*a-e*o)*(u*v-l*f)}(this)}}const Z=new g;class B{constructor(t){let{canvas:i=document.createElement("canvas"),width:s=300,height:h=150,$t:e=1,alpha:r=!1,ti:n=!0,ii:o=!1,si:a=!1,dt:u=!1,hi:l=!1,ei:c="default",ri:d=!0,ni:f=2}=void 0===t?{}:t;const v={alpha:r,ti:n,ii:o,si:a,dt:u,hi:l,ei:c};this.$t=e,this.alpha=r,this.color=!0,this.ti=n,this.ii=o,this.dt=u,this.ri=d,2===f&&(this.S=i.getContext("webgl2",v)),this.oi=!!this.S,this.S||(this.S=i.getContext("webgl",v)||i.getContext("experimental-webgl",v)),this.S.N=this,this.ai(s,h),this.ui={},this.ui.li=this.S.getParameter(this.S.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.state={},this.state.blendFunc={src:this.S.ONE,yt:this.S.ZERO},this.state.blendEquation={Ft:this.S.FUNC_ADD},this.state.cullFace=null,this.state.frontFace=this.S.CCW,this.state.depthMask=!0,this.state.depthFunc=this.S.LESS,this.state.ci=!1,this.state.flipY=!1,this.state.di=null,this.state.viewport={width:null,height:null},this.state.fi=[],this.state.vi=0,this.state.I=null,this.state.vt=new Map,this.extensions={},this.oi?(this.getExtension("EXT_color_buffer_float"),this.getExtension("OES_texture_float_linear")):(this.getExtension("OES_texture_float"),this.getExtension("OES_texture_float_linear"),this.getExtension("OES_texture_half_float"),this.getExtension("OES_texture_half_float_linear"),this.getExtension("OES_element_index_uint"),this.getExtension("OES_standard_derivatives"),this.getExtension("EXT_sRGB"),this.getExtension("WEBGL_depth_texture")),this.H=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.tt=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.$=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.T=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.j=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.rt=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES")}ai(t,i){this.width=t,this.height=i,this.S.canvas.width=t*this.$t,this.S.canvas.height=i*this.$t,Object.assign(this.S.canvas.style,{width:t+"px",height:i+"px"})}pi(t,i){this.state.viewport.width===t&&this.state.viewport.height===i||(this.state.viewport.width=t,this.state.viewport.height=i,this.S.viewport(0,0,t,i))}enable(t){!0!==this.state[t]&&(this.S.enable(t),this.state[t]=!0)}disable(t){!1!==this.state[t]&&(this.S.disable(t),this.state[t]=!1)}ft(t,i,s,h){this.state.blendFunc.src===t&&this.state.blendFunc.yt===i&&this.state.blendFunc.At===s&&this.state.blendFunc.bt===h||(this.state.blendFunc.src=t,this.state.blendFunc.yt=i,this.state.blendFunc.At=s,this.state.blendFunc.bt=h,void 0!==s?this.S.blendFuncSeparate(t,i,s,h):this.S.blendFunc(t,i))}_t(t,i){this.state.blendEquation.Ft===t&&this.state.blendEquation.Et===i||(this.state.blendEquation.Ft=t,this.state.blendEquation.Et=i,void 0!==i?this.S.blendEquationSeparate(t,i):this.S.blendEquation(t))}St(t){this.state.cullFace!==t&&(this.state.cullFace=t,this.S.cullFace(t))}Ot(t){this.state.frontFace!==t&&(this.state.frontFace=t,this.S.frontFace(t))}Xt(t){this.state.depthMask!==t&&(this.state.depthMask=t,this.S.depthMask(t))}jt(t){this.state.depthFunc!==t&&(this.state.depthFunc=t,this.S.depthFunc(t))}activeTexture(t){this.state.vi!==t&&(this.state.vi=t,this.S.activeTexture(this.S.TEXTURE0+t))}bindFramebuffer(t){let{target:i=this.S.FRAMEBUFFER,buffer:s=null}=void 0===t?{}:t;this.state.di!==s&&(this.state.di=s,this.S.bindFramebuffer(i,s))}getExtension(t,i,s){return i&&this.S[i]?this.S[i].bind(this.S):(this.extensions[t]||(this.extensions[t]=this.S.getExtension(t)),i?this.extensions[t][s].bind(this.extensions[t]):this.extensions[t])}mi(t,i){return t.wi!==i.wi?t.wi-i.wi:t.J.id!==i.J.id?t.J.id-i.J.id:t.Mi!==i.Mi?t.Mi-i.Mi:i.id-t.id}gi(t,i){return t.wi!==i.wi?t.wi-i.wi:t.Mi!==i.Mi?i.Mi-t.Mi:i.id-t.id}xi(t,i){return t.wi!==i.wi?t.wi-i.wi:t.J.id!==i.J.id?t.J.id-i.J.id:i.id-t.id}yi(t){let{Ai:i,bi:s,_i:h,sort:e}=t,r=[];if(s&&h&&s.Fi(),i.Ei(t=>{if(!t.visible)return!0;t.draw&&(h&&t.zi&&s&&!s.Si(t)||r.push(t))}),e){const t=[],i=[],h=[];r.forEach(e=>{e.J.ut?e.J.lt?i.push(e):h.push(e):t.push(e),e.Mi=0,0===e.wi&&e.J.lt&&s&&(e.Oi.Qt(Z),Z.M(s.Xi),e.Mi=Z.z)}),t.sort(this.mi),i.sort(this.gi),h.sort(this.xi),r=t.concat(i,h)}return r}ji(t){let{Ai:i,bi:s,target:h=null,update:e=!0,sort:r=!0,_i:n=!0,clear:o}=t;null===h?(this.bindFramebuffer(),this.pi(this.width*this.$t,this.height*this.$t)):(this.bindFramebuffer(h),this.pi(h.width,h.height)),(o||this.ri&&!1!==o)&&(!this.ti||h&&h.ti||(this.enable(this.S.DEPTH_TEST),this.Xt(!0)),this.S.clear((this.color?this.S.COLOR_BUFFER_BIT:0)|(this.ti?this.S.DEPTH_BUFFER_BIT:0)|(this.ii?this.S.STENCIL_BUFFER_BIT:0))),e&&i.Ni(),s&&null===s.parent&&s.Ni(),this.yi({Ai:i,bi:s,_i:n,sort:r}).forEach(t=>{t.draw({bi:s})})}}function C(t,i,s,h,e){return t[0]=i,t[1]=s,t[2]=h,t[3]=e,t}function D(t,i){let s=i[0],h=i[1],e=i[2],r=i[3],n=s*s+h*h+e*e+r*r;return n>0&&(n=1/Math.sqrt(n)),t[0]=s*n,t[1]=h*n,t[2]=e*n,t[3]=r*n,t}function V(t,i,s){let h=i[0],e=i[1],r=i[2],n=i[3],o=s[0],a=s[1],u=s[2],l=s[3];return t[0]=h*l+n*o+e*u-r*a,t[1]=e*l+n*a+r*o-h*u,t[2]=r*l+n*u+h*a-e*o,t[3]=n*l-h*o-e*a-r*u,t}function q(t,i,s,h){let e,r,n,o,a,u=i[0],l=i[1],c=i[2],d=i[3],f=s[0],v=s[1],p=s[2],m=s[3];return(r=u*f+l*v+c*p+d*m)<0&&(r=-r,f=-f,v=-v,p=-p,m=-m),1-r>1e-6?(e=Math.acos(r),n=Math.sin(e),o=Math.sin((1-h)*e)/n,a=Math.sin(h*e)/n):(o=1-h,a=h),t[0]=o*u+a*f,t[1]=o*l+a*v,t[2]=o*c+a*p,t[3]=o*d+a*m,t}function I(t,i){let s,h=i[0]+i[4]+i[8];if(h>0)s=Math.sqrt(h+1),t[3]=.5*s,s=.5/s,t[0]=(i[5]-i[7])*s,t[1]=(i[6]-i[2])*s,t[2]=(i[1]-i[3])*s;else{let h=0;i[4]>i[0]&&(h=1),i[8]>i[3*h+h]&&(h=2);let e=(h+1)%3,r=(h+2)%3;s=Math.sqrt(i[3*h+h]-i[3*e+e]-i[3*r+r]+1),t[h]=.5*s,s=.5/s,t[3]=(i[3*e+r]-i[3*r+e])*s,t[e]=(i[3*e+h]+i[3*h+e])*s,t[r]=(i[3*r+h]+i[3*h+r])*s}return t}const L=function(t,i){return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t},P=C,G=function(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]+t[3]*i[3]},U=D;(function(){const t=[0,0,0],i=[1,0,0],s=[0,1,0]})(),function(){let t=[0,0,0,1],i=[0,0,0,1]}(),function(){const t=[1,0,0,0,1,0,0,0,1]}();class R extends Array{constructor(t,i,s,h){return void 0===t&&(t=0),void 0===i&&(i=0),void 0===s&&(s=0),void 0===h&&(h=1),super(t,i,s,h),this.Yi=()=>{},this}get x(){return this[0]}set x(t){this[0]=t,this.Yi()}get y(){return this[1]}set y(t){this[1]=t,this.Yi()}get z(){return this[2]}set z(t){this[2]=t,this.Yi()}get w(){return this[3]}set w(t){this[3]=t,this.Yi()}identity(){var t;return(t=this)[0]=0,t[1]=0,t[2]=0,t[3]=1,this.Yi(),this}set(t,i,s,h){return P(this,t,i,s,h),this.Yi(),this}Dt(t){return function(t,i,s){s*=.5;let h=i[0],e=i[1],r=i[2],n=i[3],o=Math.sin(s),a=Math.cos(s);t[0]=h*a+n*o,t[1]=e*a+r*o,t[2]=r*a-e*o,t[3]=n*a-h*o}(this,this,t),this.Yi(),this}Vt(t){return function(t,i,s){s*=.5;let h=i[0],e=i[1],r=i[2],n=i[3],o=Math.sin(s),a=Math.cos(s);t[0]=h*a-r*o,t[1]=e*a+n*o,t[2]=r*a+h*o,t[3]=n*a-e*o}(this,this,t),this.Yi(),this}qt(t){return function(t,i,s){s*=.5;let h=i[0],e=i[1],r=i[2],n=i[3],o=Math.sin(s),a=Math.cos(s);t[0]=h*a+e*o,t[1]=e*a-h*o,t[2]=r*a+n*o,t[3]=n*a-r*o}(this,this,t),this.Yi(),this}inverse(t){return void 0===t&&(t=this),function(t,i){let s=i[0],h=i[1],e=i[2],r=i[3],n=s*s+h*h+e*e+r*r,o=n?1/n:0;t[0]=-s*o,t[1]=-h*o,t[2]=-e*o,t[3]=r*o}(this,t),this.Yi(),this}Zi(t){var i,s;return void 0===t&&(t=this),s=t,(i=this)[0]=-s[0],i[1]=-s[1],i[2]=-s[2],i[3]=s[3],this.Yi(),this}t(t){return L(this,t),this.Yi(),this}normalize(t){return void 0===t&&(t=this),U(this,t),this.Yi(),this}multiply(t,i){return i?V(this,t,i):V(this,this,t),this.Yi(),this}p(t){return G(this,t)}Bi(t){return I(this,t),this.Yi(),this}Ci(t){return function(t,i,s){void 0===s&&(s="YXZ");let h=Math.sin(.5*i[0]),e=Math.cos(.5*i[0]),r=Math.sin(.5*i[1]),n=Math.cos(.5*i[1]),o=Math.sin(.5*i[2]),a=Math.cos(.5*i[2]);"XYZ"===s?(t[0]=h*n*a+e*r*o,t[1]=e*r*a-h*n*o,t[2]=e*n*o+h*r*a,t[3]=e*n*a-h*r*o):"YXZ"===s?(t[0]=h*n*a+e*r*o,t[1]=e*r*a-h*n*o,t[2]=e*n*o-h*r*a,t[3]=e*n*a+h*r*o):"ZXY"===s?(t[0]=h*n*a-e*r*o,t[1]=e*r*a+h*n*o,t[2]=e*n*o+h*r*a,t[3]=e*n*a-h*r*o):"ZYX"===s?(t[0]=h*n*a-e*r*o,t[1]=e*r*a+h*n*o,t[2]=e*n*o-h*r*a,t[3]=e*n*a+h*r*o):"YZX"===s?(t[0]=h*n*a+e*r*o,t[1]=e*r*a+h*n*o,t[2]=e*n*o-h*r*a,t[3]=e*n*a-h*r*o):"XZY"===s&&(t[0]=h*n*a-e*r*o,t[1]=e*r*a-h*n*o,t[2]=e*n*o+h*r*a,t[3]=e*n*a+h*r*o)}(this,t,t.order),this}Di(t,i){return q(this,this,t,i),this}_(t,i){return void 0===i&&(i=0),this[0]=t[i],this[1]=t[i+1],this[2]=t[i+2],this[3]=t[i+3],this}toArray(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this[0],t[i+1]=this[1],t[i+2]=this[2],t[i+3]=this[3],t}}const T=new Y;class k extends Array{constructor(t,i,s,h){return void 0===t&&(t=0),void 0===i&&(i=t),void 0===s&&(s=t),void 0===h&&(h="YXZ"),super(t,i,s),this.order=h,this.Yi=()=>{},this}get x(){return this[0]}set x(t){this[0]=t,this.Yi()}get y(){return this[1]}set y(t){this[1]=t,this.Yi()}get z(){return this[2]}set z(t){this[2]=t,this.Yi()}set(t,i,s){return void 0===i&&(i=t),void 0===s&&(s=t),this[0]=t,this[1]=i,this[2]=s,this.Yi(),this}Vi(t){return this.order=t,this.Yi(),this}qi(t,i){return void 0===i&&(i=this.order),function(t,i,s){void 0===s&&(s="YXZ"),"XYZ"===s?(t[1]=Math.asin(Math.min(Math.max(i[8],-1),1)),Math.abs(i[8])<.99999?(t[0]=Math.atan2(-i[9],i[10]),t[2]=Math.atan2(-i[4],i[0])):(t[0]=Math.atan2(i[6],i[5]),t[2]=0)):"YXZ"===s?(t[0]=Math.asin(-Math.min(Math.max(i[9],-1),1)),Math.abs(i[9])<.99999?(t[1]=Math.atan2(i[8],i[10]),t[2]=Math.atan2(i[1],i[5])):(t[1]=Math.atan2(-i[2],i[0]),t[2]=0)):"ZXY"===s?(t[0]=Math.asin(Math.min(Math.max(i[6],-1),1)),Math.abs(i[6])<.99999?(t[1]=Math.atan2(-i[2],i[10]),t[2]=Math.atan2(-i[4],i[5])):(t[1]=0,t[2]=Math.atan2(i[1],i[0]))):"ZYX"===s?(t[1]=Math.asin(-Math.min(Math.max(i[2],-1),1)),Math.abs(i[2])<.99999?(t[0]=Math.atan2(i[6],i[10]),t[2]=Math.atan2(i[1],i[0])):(t[0]=0,t[2]=Math.atan2(-i[4],i[5]))):"YZX"===s?(t[2]=Math.asin(Math.min(Math.max(i[1],-1),1)),Math.abs(i[1])<.99999?(t[0]=Math.atan2(-i[9],i[5]),t[1]=Math.atan2(-i[2],i[0])):(t[0]=0,t[1]=Math.atan2(i[8],i[10]))):"XZY"===s&&(t[2]=Math.asin(-Math.min(Math.max(i[4],-1),1)),Math.abs(i[4])<.99999?(t[0]=Math.atan2(i[6],i[5]),t[1]=Math.atan2(i[8],i[0])):(t[0]=Math.atan2(-i[9],i[10]),t[1]=0))}(this,t,i),this}Rt(t,i){return void 0===i&&(i=this.order),T.Rt(t),this.qi(T,i)}}class Q{constructor(){this.parent=null,this.children=[],this.visible=!0,this.matrix=new Y,this.Oi=new Y,this.Ii=!0,this.position=new g,this.Li=new R,this.scale=new g(1),this.rotation=new k,this.Pi=new g(0,1,0),this.rotation.Yi=()=>this.Li.Ci(this.rotation),this.Li.Yi=()=>this.rotation.Rt(this.Li)}Gi(t,i){void 0===i&&(i=!0),i&&this.parent&&t!==this.parent&&this.parent.removeChild(this,!1),this.parent=t,i&&t&&t.Ui(this,!1)}Ui(t,i){void 0===i&&(i=!0),~this.children.indexOf(t)||this.children.push(t),i&&t.Gi(this,!1)}removeChild(t,i){void 0===i&&(i=!0),~this.children.indexOf(t)&&this.children.splice(this.children.indexOf(t),1),i&&t.Gi(null,!1)}Ni(t){this.Ii&&this.Ri(),(this.Ti||t)&&(null===this.parent?this.Oi.t(this.matrix):this.Oi.multiply(this.parent.Oi,this.matrix),this.Ti=!1,t=!0);for(let i=0,s=this.children.length;i<s;i++)this.children[i].Ni(t)}Ri(){this.matrix.Tt(this.Li,this.position,this.scale),this.Ti=!0}Ei(t){if(!t(this))for(let i=0,s=this.children.length;i<s;i++)this.children[i].Ei(t)}ki(){this.matrix.Qt(this.position),this.matrix.kt(this.Li),this.matrix.Wt(this.scale),this.rotation.Rt(this.Li)}Jt(t,i){void 0===i&&(i=!1),i?this.matrix.Jt(this.position,t,this.Pi):this.matrix.Jt(t,this.position,this.Pi),this.matrix.kt(this.Li),this.rotation.Rt(this.Li)}}const W=new Y,H=new g,J=new g;class K extends Q{constructor(t,i){let{near:s=.1,Gt:h=100,Lt:e=45,Pt:r=1,left:n,right:o,bottom:a,top:u}=void 0===i?{}:i;super(t),this.near=s,this.Gt=h,this.Lt=e,this.Pt=r,this.projectionMatrix=new Y,this.Qi=new Y,this.Xi=new Y,n||o?this.Wi({left:n,right:o,bottom:a,top:u}):this.perspective()}perspective(t){let{near:i=this.near,Gt:s=this.Gt,Lt:h=this.Lt,Pt:e=this.Pt}=void 0===t?{}:t;return this.projectionMatrix.It({Lt:h*(Math.PI/180),Pt:e,near:i,Gt:s}),this.type="perspective",this}Wi(t){let{near:i=this.near,Gt:s=this.Gt,left:h=-1,right:e=1,bottom:r=-1,top:n=1}=void 0===t?{}:t;return this.projectionMatrix.Ut({left:h,right:e,bottom:r,top:n,near:i,Gt:s}),this.type="orthographic",this}Ni(){return super.Ni(),this.Qi.inverse(this.Oi),this.Xi.multiply(this.projectionMatrix,this.Qi),this}Jt(t){return super.Jt(t,!0),this}Hi(t){return t.M(this.Qi),t.M(this.projectionMatrix),this}Ji(t){return t.M(W.inverse(this.projectionMatrix)),t.M(this.Oi),this}Fi(){this.Ki||(this.Ki=[new g,new g,new g,new g,new g,new g]);const t=this.Xi;this.Ki[0].set(t[3]-t[0],t[7]-t[4],t[11]-t[8]).$i=t[15]-t[12],this.Ki[1].set(t[3]+t[0],t[7]+t[4],t[11]+t[8]).$i=t[15]+t[12],this.Ki[2].set(t[3]+t[1],t[7]+t[5],t[11]+t[9]).$i=t[15]+t[13],this.Ki[3].set(t[3]-t[1],t[7]-t[5],t[11]-t[9]).$i=t[15]-t[13],this.Ki[4].set(t[3]-t[2],t[7]-t[6],t[11]-t[10]).$i=t[15]-t[14],this.Ki[5].set(t[3]+t[2],t[7]+t[6],t[11]+t[10]).$i=t[15]+t[14];for(let t=0;t<6;t++){const i=1/this.Ki[t].h();this.Ki[t].multiply(i),this.Ki[t].$i*=i}}Si(t){t.ts.bounds&&t.ts.bounds.ht!==1/0||t.ts.et();const i=H;i.t(t.ts.bounds.st),i.M(t.Oi);const s=t.ts.bounds.ht*t.Oi.Ht();return this.ss(i,s)}ss(t,i){const s=J;for(let h=0;h<6;h++){const e=this.Ki[h];if(s.t(e).p(t)+e.$i<-i)return!1}return!0}}function $(t,i,s){let h=i[0],e=i[1],r=i[2],n=i[3],o=i[4],a=i[5],u=i[6],l=i[7],c=i[8],d=s[0],f=s[1],v=s[2],p=s[3],m=s[4],w=s[5],M=s[6],g=s[7],x=s[8];return t[0]=d*h+f*n+v*u,t[1]=d*e+f*o+v*l,t[2]=d*r+f*a+v*c,t[3]=p*h+m*n+w*u,t[4]=p*e+m*o+w*l,t[5]=p*r+m*a+w*c,t[6]=M*h+g*n+x*u,t[7]=M*e+g*o+x*l,t[8]=M*r+g*a+x*c,t}class tt extends Array{constructor(t,i,s,h,e,r,n,o,a){return void 0===t&&(t=1),void 0===i&&(i=0),void 0===s&&(s=0),void 0===h&&(h=0),void 0===e&&(e=1),void 0===r&&(r=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=1),super(t,i,s,h,e,r,n,o,a),this}set(t,i,s,h,e,r,n,o,a){return function(t,i,s,h,e,r,n,o,a,u){t[0]=i,t[1]=s,t[2]=h,t[3]=e,t[4]=r,t[5]=n,t[6]=o,t[7]=a,t[8]=u}(this,t,i,s,h,e,r,n,o,a),this}translate(t,i){return void 0===i&&(i=this),function(t,i,s){let h=i[0],e=i[1],r=i[2],n=i[3],o=i[4],a=i[5],u=i[6],l=i[7],c=i[8],d=s[0],f=s[1];t[0]=h,t[1]=e,t[2]=r,t[3]=n,t[4]=o,t[5]=a,t[6]=d*h+f*n+u,t[7]=d*e+f*o+l,t[8]=d*r+f*a+c}(this,i,t),this}rotate(t,i){return void 0===i&&(i=this),function(t,i,s){let h=i[0],e=i[1],r=i[2],n=i[3],o=i[4],a=i[5],u=i[6],l=i[7],c=i[8],d=Math.sin(s),f=Math.cos(s);t[0]=f*h+d*n,t[1]=f*e+d*o,t[2]=f*r+d*a,t[3]=f*n-d*h,t[4]=f*o-d*e,t[5]=f*a-d*r,t[6]=u,t[7]=l,t[8]=c}(this,i,t),this}scale(t,i){return void 0===i&&(i=this),function(t,i,s){let h=s[0],e=s[1];t[0]=h*i[0],t[1]=h*i[1],t[2]=h*i[2],t[3]=e*i[3],t[4]=e*i[4],t[5]=e*i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8]}(this,i,t),this}multiply(t,i){return i?$(this,t,i):$(this,this,t),this}identity(){var t;return(t=this)[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this}t(t){var i,s;return s=t,(i=this)[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i[4]=s[4],i[5]=s[5],i[6]=s[6],i[7]=s[7],i[8]=s[8],this}hs(t){var i,s;return s=t,(i=this)[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[4],i[4]=s[5],i[5]=s[6],i[6]=s[8],i[7]=s[9],i[8]=s[10],this}Rt(t){return function(t,i){let s=i[0],h=i[1],e=i[2],r=i[3],n=s+s,o=h+h,a=e+e,u=s*n,l=h*n,c=h*o,d=e*n,f=e*o,v=e*a,p=r*n,m=r*o,w=r*a;t[0]=1-c-v,t[3]=l-w,t[6]=d+m,t[1]=l+w,t[4]=1-u-v,t[7]=f-p,t[2]=d-m,t[5]=f+p,t[8]=1-u-c}(this,t),this}es(t,i,s){return this.set(t[0],t[1],t[2],i[0],i[1],i[2],s[0],s[1],s[2]),this}inverse(t){return void 0===t&&(t=this),function(t,i){let s=i[0],h=i[1],e=i[2],r=i[3],n=i[4],o=i[5],a=i[6],u=i[7],l=i[8],c=l*n-o*u,d=-l*r+o*a,f=u*r-n*a,v=s*c+h*d+e*f;v&&(v=1/v,t[0]=c*v,t[1]=(-l*h+e*u)*v,t[2]=(o*h-e*n)*v,t[3]=d*v,t[4]=(l*s-e*a)*v,t[5]=(-o*s+e*r)*v,t[6]=f*v,t[7]=(-u*s+h*a)*v,t[8]=(n*s-h*r)*v)}(this,t),this}rs(t){return function(t,i){let s=i[0],h=i[1],e=i[2],r=i[3],n=i[4],o=i[5],a=i[6],u=i[7],l=i[8],c=i[9],d=i[10],f=i[11],v=i[12],p=i[13],m=i[14],w=i[15],M=s*o-h*n,g=s*a-e*n,x=s*u-r*n,y=h*a-e*o,A=h*u-r*o,b=e*u-r*a,_=l*p-c*v,F=l*m-d*v,E=l*w-f*v,z=c*m-d*p,S=c*w-f*p,O=d*w-f*m,X=M*O-g*S+x*z+y*E-A*F+b*_;X&&(X=1/X,t[0]=(o*O-a*S+u*z)*X,t[1]=(a*E-n*O-u*F)*X,t[2]=(n*S-o*E+u*_)*X,t[3]=(e*S-h*O-r*z)*X,t[4]=(s*O-e*E+r*F)*X,t[5]=(h*E-s*S-r*_)*X,t[6]=(p*b-m*A+w*y)*X,t[7]=(m*x-v*b-w*g)*X,t[8]=(v*A-p*x+w*M)*X)}(this,t),this}}let it=0;class st extends Q{constructor(t,i){let{ts:s,J:h,mode:e=t.TRIANGLES,zi:r=!0,wi:n=0}=void 0===i?{}:i;super(t),this.S=t,this.id=it++,this.ts=s,this.J=h,this.mode=e,this.zi=r,this.wi=n,this.modelViewMatrix=new Y,this.normalMatrix=new tt,this.J.at.ns||Object.assign(this.J.at,{ns:{value:null},Qi:{value:null},modelViewMatrix:{value:null},normalMatrix:{value:null},projectionMatrix:{value:null},os:{value:null}})}draw(t){let{bi:i}=void 0===t?{}:t;this.as&&this.as({us:this,bi:i}),i&&(this.J.at.projectionMatrix.value=i.projectionMatrix,this.J.at.os.value=i.position,this.J.at.Qi.value=i.Qi,this.modelViewMatrix.multiply(i.Qi,this.Oi),this.normalMatrix.rs(this.modelViewMatrix),this.J.at.ns.value=this.Oi,this.J.at.modelViewMatrix.value=this.modelViewMatrix,this.J.at.normalMatrix.value=this.normalMatrix);let s=this.J.cullFace&&this.Oi.Kt()<0;const h=this.S.N.Bt===this.J.id,e=this.S.N.Y===this.ts.id;this.J.Nt({Yt:h,Zt:s}),this.ts.draw({mode:this.mode,J:this.J,K:e}),this.ls&&this.ls({us:this,bi:i})}}new Uint8Array(4);function ht(t,i,s){return t[0]=i[0]+s[0],t[1]=i[1]+s[1],t}function et(t,i,s){return t[0]=i[0]-s[0],t[1]=i[1]-s[1],t}function rt(t,i,s){return t[0]=i[0]*s,t[1]=i[1]*s,t}function nt(t){var i=t[0],s=t[1];return Math.sqrt(i*i+s*s)}class ot extends Array{constructor(t,i){return void 0===t&&(t=0),void 0===i&&(i=t),super(t,i),this}get x(){return this[0]}set x(t){this[0]=t}get y(){return this[1]}set y(t){this[1]=t}set(t,i){return void 0===i&&(i=t),function(t,i,s){t[0]=i,t[1]=s}(this,t,i),this}t(t){var i,s;return s=t,(i=this)[0]=s[0],i[1]=s[1],this}add(t,i){return i?ht(this,t,i):ht(this,this,t),this}sub(t,i){return i?et(this,t,i):et(this,this,t),this}multiply(t){var i,s,h;return t.length?(s=this,h=t,(i=this)[0]=s[0]*h[0],i[1]=s[1]*h[1]):rt(this,this,t),this}i(t){var i,s,h;return t.length?(s=this,h=t,(i=this)[0]=s[0]/h[0],i[1]=s[1]/h[1]):rt(this,this,1/t),this}inverse(t){var i,s;return void 0===t&&(t=this),s=t,(i=this)[0]=1/s[0],i[1]=1/s[1],this}s(){return nt(this)}h(t){return t?(i=this,h=(s=t)[0]-i[0],e=s[1]-i[1],Math.sqrt(h*h+e*e)):nt(this);var i,s,h,e}o(){return this.u()}u(t){return t?(i=this,h=(s=t)[0]-i[0],e=s[1]-i[1],h*h+e*e):function(t){var i=t[0],s=t[1];return i*i+s*s}(this);var i,s,h,e}l(t){var i,s;return void 0===t&&(t=this),s=t,(i=this)[0]=-s[0],i[1]=-s[1],this}v(t,i){return h=i,(s=t)[0]*h[1]-s[1]*h[0];var s,h}scale(t){return rt(this,this,t),this}normalize(){var t,i,s,h,e;return t=this,s=(i=this)[0],h=i[1],(e=s*s+h*h)>0&&(e=1/Math.sqrt(e)),t[0]=i[0]*e,t[1]=i[1]*e,this}p(t){return s=t,(i=this)[0]*s[0]+i[1]*s[1];var i,s}m(t){return s=t,(i=this)[0]===s[0]&&i[1]===s[1];var i,s}cs(t){var i,s,h,e,r;return i=this,h=t,e=(s=this)[0],r=s[1],i[0]=h[0]*e+h[3]*r+h[6],i[1]=h[1]*e+h[4]*r+h[7],this}M(t){return function(t,i,s){let h=i[0],e=i[1];t[0]=s[0]*h+s[4]*e+s[12],t[1]=s[1]*h+s[5]*e+s[13]}(this,this,t),this}A(t,i){!function(t,i,s,h){var e=i[0],r=i[1];t[0]=e+h*(s[0]-e),t[1]=r+h*(s[1]-r)}(this,this,t,i)}clone(){return new ot(this[0],this[1])}_(t,i){return void 0===i&&(i=0),this[0]=t[i],this[1]=t[i+1],this}toArray(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this[0],t[i+1]=this[1],t}}class at extends b{constructor(t,i){let{width:s=1,height:h=1,attributes:e={},ds:r=null}=void 0===i?{}:i;if(!r)throw new Error("need positions");const n=4*r.length,o=6*r.length,a=new Float32Array(3*n),u=new Float32Array(3*n),l=new Float32Array(2*n),c=n>65536?new Uint32Array(o):new Uint16Array(o);let d=0,f=0;for(let t of r)at.fs(a,u,l,c,s,h,0,2,1,d,f,...t),d+=4,f+=1;Object.assign(e,{position:{size:3,data:a},normal:{size:3,data:u},vs:{size:2,data:l},index:{data:c}}),super(t,e)}static fs(t,i,s,h,e,r,n,o,a,u,l,c,d,f){void 0===n&&(n=0),void 0===o&&(o=1),void 0===a&&(a=2),void 0===u&&(u=0),void 0===l&&(l=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===f&&(f=0);const v=u;for(let p=0;p<=1;p++){let m=p*r-r/2-d;for(let r=0;r<=1;r++,u++){let d=r*e-e/2-c;if(t[3*u+n]=-d,t[3*u+o]=-m,t[3*u+a]=f,i[3*u+n]=0,i[3*u+o]=0,i[3*u+a]=1,s[2*u]=r,s[2*u+1]=1-p,1===p||1===r)continue;let w=v+r+2*p,M=v+r+2*(p+1),g=v+r+2*(p+1)+1,x=v+r+2*p+1;h[6*l]=w,h[6*l+1]=M,h[6*l+2]=x,h[6*l+3]=M,h[6*l+4]=g,h[6*l+5]=x,l++}}}}var ut=at;class lt extends b{constructor(t,i){let{width:s=1,height:h=1,ps:e=1,ms:r=1,attributes:n={}}=void 0===i?{}:i;const o=e,a=r,u=(o+1)*(a+1),l=o*a*6,c=new Float32Array(3*u),d=new Float32Array(3*u),f=new Float32Array(2*u),v=u>65536?new Uint32Array(l):new Uint16Array(l);lt.fs(c,d,f,v,s,h,0,o,a),Object.assign(n,{position:{size:3,data:c},normal:{size:3,data:d},vs:{size:2,data:f},index:{data:v}}),super(t,n)}static fs(t,i,s,h,e,r,n,o,a,u,l,c,d,f,v,p){void 0===u&&(u=0),void 0===l&&(l=1),void 0===c&&(c=2),void 0===d&&(d=1),void 0===f&&(f=-1),void 0===v&&(v=0),void 0===p&&(p=0);const m=v,w=e/o,M=r/a;for(let g=0;g<=a;g++){let x=g*M-r/2;for(let r=0;r<=o;r++,v++){let M=r*w-e/2;if(t[3*v+u]=M*d,t[3*v+l]=x*f,t[3*v+c]=n/2,i[3*v+u]=0,i[3*v+l]=0,i[3*v+c]=n>=0?1:-1,s[2*v]=r/o,s[2*v+1]=1-g/a,g===a||r===o)continue;let y=m+r+g*(o+1),A=m+r+(g+1)*(o+1),b=m+r+(g+1)*(o+1)+1,_=m+r+g*(o+1)+1;h[6*p]=y,h[6*p+1]=A,h[6*p+2]=_,h[6*p+3]=A,h[6*p+4]=b,h[6*p+5]=_,p++}}}}class ct extends b{constructor(t,i){let{width:s=1,height:h=1,ti:e=1,ps:r=1,ms:n=1,ws:o=1,attributes:a={}}=void 0===i?{}:i;const u=r,l=n,c=o,d=(u+1)*(l+1)*2+(u+1)*(c+1)*2+(l+1)*(c+1)*2,f=6*(u*l*2+u*c*2+l*c*2),v=new Float32Array(3*d),p=new Float32Array(3*d),m=new Float32Array(2*d),w=d>65536?new Uint32Array(f):new Uint16Array(f);let M=0,g=0;lt.fs(v,p,m,w,e,h,s,c,l,2,1,0,-1,-1,M,g),lt.fs(v,p,m,w,e,h,-s,c,l,2,1,0,1,-1,M+=(c+1)*(l+1),g+=c*l),lt.fs(v,p,m,w,s,e,h,c,l,0,2,1,1,1,M+=(c+1)*(l+1),g+=c*l),lt.fs(v,p,m,w,s,e,-h,c,l,0,2,1,1,-1,M+=(u+1)*(c+1),g+=u*c),lt.fs(v,p,m,w,s,h,-e,u,l,0,1,2,-1,-1,M+=(u+1)*(c+1),g+=u*c),lt.fs(v,p,m,w,s,h,e,u,l,0,1,2,1,-1,M+=(u+1)*(l+1),g+=u*l),Object.assign(a,{position:{size:3,data:v},normal:{size:3,data:p},vs:{size:2,data:m},index:{data:w}}),super(t,a)}}new g,new ot,new ot;new g,new g,new g,new Y;new g,new R,new g,new g,new R,new g;new Y;function dt(t){let i=0,s=0;for(let h of t)for(let t of h){s+=t.count-0;const h=t.count-0;i<h&&(i=h)}return{Ms:i,gs:s}}
/*! ContributeForest v0.0.3 | Yukimasa Funaoka <yukimasafunaoka@gmail.com> */var ft=class{constructor(t){this.xs=document.body,this.data=[],this.ys=800,this.As=350,this.bs=5.5,this._s=1.8,this.Fs=.25,Object.assign(this,t),this.w=this.ys,this.Es=this.As,this.zs=this.As/this.ys,this.animate=this.animate.bind(this),this.Ss=this.Ss.bind(this),this.Os=this._s+this.Fs,this.Xs=Date.now(),this.Ms=dt(this.data).Ms,this.N=new B({si:!0}),this.S=this.N.S,document.getElementById("forest-view").appendChild(this.S.canvas),this.S.clearColor(1,1,1,1),this.js=[],this.Ai=new Q,this.bi=new K(this.S,{Lt:30,Gt:1e3}),this.bi.position.set(0,0,100),this.bi.Jt([0,0,0]),this.Ns(),this.Ss(),window.addEventListener("resize",this.Ss)}Ss(){this.w=Math.min(window.innerWidth,this.ys),this.Es=this.w*this.zs,this.N.$t=Math.max(window.devicePixelRatio,2),this.N.ai(this.w,this.Es),this.bi.perspective({Pt:this.S.canvas.width/this.S.canvas.height}),this.N.ji({Ai:this.Ai,bi:this.bi})}Ns(){const t=this.data.length,i=new ct(this.S,{width:this._s,ti:this._s,height:this.bs}),s=new E(this.S,{nt:n,ot:o()}),h=new E(this.S,{nt:a,ot:u,at:{color:{value:null}}}),e=[];for(let s=0;s<this.data.length;s++){const n=this.data[s];this.js[s]=[];const o=0+(s-t/2-2)*this.Os;for(let a=0;a<n.length;a++){const u=a*this.Os;let l=n[a].count/this.Ms*.2;const c=new g(...r(360/t*s,.7,.65-l)),d=function(){h.at.color.value=c},f=new st(this.S,{ts:i,J:h});f.position.set(o,8.25,u),f.as=d,f.Gi(this.Ai),this.js[s][a]=f,e.push([o,u])}}const l=new ut(this.S,{width:this._s,height:this._s,ds:e});new st(this.S,{ts:l,J:s}).Gi(this.Ai),this.Ai.rotation.x=.32,this.Ai.rotation.y=-.64,this.Ai.rotation.z=-.22,this.N.ji({Ai:this.Ai,bi:this.bi})}animate(){const t=(Date.now()-this.Xs)/16.6666,i=this.js.length+20;t<i&&requestAnimationFrame(this.animate);for(let i=0;i<this.js.length;i++)for(let h=0;h<this.js[i].length;h++){const e=this.js[i][h],r=this.data[i][h];let n=0;t>=i&&(s=(t-i)/20,n=(s-=1)*s*(2.7*s+1.7)+1,t-i>=20&&(n=1)),n*=(r.count-0)/this.Ms*3,e.position.set(e.position.x,this.bs*n/2,e.position.z),n&&(e.scale.y=n),e.visible=!!n}var s;const e=t/i;this.Ai.rotation.x=.32+.18*h(e),this.Ai.rotation.y=.2*h(e)-.64,this.N.ji({Ai:this.Ai,bi:this.bi})}};s.d(i,"draw",function(){return vt});const vt=function(t){const i=document.getElementById("forest-view");i.className="loaded",new ft({data:t,xs:i}).animate(),function(t){const i=document.getElementById("forest-view__contributions__count"),s=dt(t).gs,e=t.length+13,r=new Intl.NumberFormat;let n=Date.now(),o=0;!function t(){const a=(Date.now()-n)/16.6666;a<e&&(requestAnimationFrame(t),++o%2)||(i.textContent=r.format(s*h(a/e)|0))}()}(t)}}]]);